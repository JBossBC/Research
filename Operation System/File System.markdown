# File System


文件是操作系统在进行存储时使用的最多的抽象之一。每个文件实质上是一个有名字的字符序列。序列的内容为文件数据，而序列长度、序列修改的时间等描述文件数据的属性、支撑文件功能的其他信息称为文件元数据。**应用程序使用一组特定的接口对文件进行访问，如打开、定位、读取、写入和关闭等**。文件名用来区分不同的文件，通常保存在目录中。每个文件名和对应的文件地址或编号组成一个目录项，一个或多个目录项组成一个目录。一般情况下，目录本身被设计成一种特殊的文件，应用程序需要使用专门的接口来操作目录，例如创建目录（mkdir)和删除目录(rmdir)等。**实现文件接口并负责管理文件数据和元数据的系统，即为文件系统**

文件系统是操作系统中文件的管理者。对上层用户和应用程序来说，文件系统提供文件抽象并实现文件访问所需要的接口，对下层存储设备来说，文件系统以特定格式在存储设备上维护着每个文件的数据和元数据。通常来说，文件系统将文件保存在存储设备中。操作系统将这些存储设备抽象为块设备，以方便文件系统使用统一的接口访问。块设备上的存储空间在逻辑上被划分为固定大小的存储块。块，是块设备读写的最小单元，大小一般为512字节或4kb。每个存储块均有一个地址，称为块号。文件系统在请求中指定块号，操作系统负责对块设备中的指定块进行数据写入和读取。

### Demo

当下载工具从网络中获取到文件内容之后，文件内容被暂存在下载工具的内存中。为了将这些数据持久保存下来，下载工具向操作系统发起了一系列**系统调用(如open和write等)。**在处理系统调用时，linux内核会调用其虚拟文件系统处理文件请求。虚拟文件系统如同一个大管家，负责管理具体的文件系统，并提供一系列服务，如**页缓存**、**inode缓存**、和**目录项缓存**等。linux虚拟文件系统在解析用户的请求后，调用具体的文件系统的接口