#  IP




## ip地址的重要特点:

+ 每一个ip地址都由网络号和主机号两部分组成。从这个意义上说，ip地址是一种分等级的地址结构。分两个等级的好处是:第一、ip地址管理机构在分配ip地址时只分配网络号，而剩下的主机号则由得到该网络号的单位自行分配，这样就方便了ip地址的管理；第二、**路由器仅根据目标主机所连接的网络号来转发分组(而不考虑目标主机号)**，这样就可以使路由表中的项目数大幅度减少，从而减小了路由表所占的存储空间以及查找路由表的时间。
+ 实际上ip地址就是标志一台主机(或路由器)和一条链路的接口。当一台主机同时连接到两个网络上时，该主机就必须同时具有两个相应的ip地址，其网络号必须是不同的。**由于一个路由器应当连接到两个网络，因此一个路由器至少应当有两个不同的ip地址**
+ 按照互联网的观点，一个网络是指具有相同网络号的主机的集合，因此，用转发器或网桥连接起来的若干个局域网仍为一个网络，因为这些局域网都具有相同的网络号。具有不同网络号的局域网必须使用路由器进行互联
+ 在ip地址中，所有分配到网络号的网络(不管是范围很小的局域网，还是可能覆盖很大地理范围的广域网)都是平等的。所谓平等，是指互联网同等对待每一个ip地址

## ARP(address resolution protocol)

在实际应用中，我们经常会遇到这样的问题:已经知道了一个机器的ip地址，需要找到其相应的硬件地址。地址解析协议ARP就是用来解决这样的问题的。

地址解析协议ARP在主机ARP高速缓存中存放一个从ip地址到硬件地址的映射表，并且这个映射表还经常动态更新。

当主机A要向本局域网上的某台主机B发送IP数据报时，就在其ARP高速缓存中查找有无主机B的IP地址，如果有，就在AR高速缓存中查出其对应的MAC地址，再将这个MAC地址写入MAC帧，然后通过局域网把该MAC帧发往此硬件地址。当查不到主机B的IP地址的时候，主机A就自动运行ARP，然后按照以下步骤找出主机B的硬件地址。

    1. ARP进程在本局域网上广播发送一个ARP请求分组ARP请求分组的首要内容是:"我的IP地址是XXX，硬件地址是XXX，我想要知道ip地址为XXX的主机的硬件地址。"
    2. 在本局域网上的所有主机运行的ARP进程都收到此ARP请求分组
    3. 主机B的IP地址与ARP请求分组中查询的IP地址一致，就收下这个ARP请求分组，并向主机A发送ARP请求分组，同时在这个ARP相应分组中写入自己的硬件地址。。其余的所有主机的ip地址与ARP请求分组中要查询的ip地址不一致，因此不理睬这个ARP请求分组。ARP响应分组的主要内容是：“我的IP地址是209.0.0.6，我的硬件地址是08-002B00EEOA.”请注意：虽然ARP请求分组是广播发送的，但ARP响应分组是普通的单播。
    4. 主机A收到主机B的ARP响应分组后，就在其ARP高速缓存中写入主机B的ip地址到硬件地址的映射

![](https://img-blog.csdnimg.cn/20200421214616775.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1RoaW5QaWthY2h1,size_16,color_FFFFFF,t_70)