# CAP 与 BASE


CAP定理是分布式系统中必定要了解的内容。它指的是，对于一个分布式系统，一致性，可用性，分区容错性最多只能同时满足其中两个。

+ 一致性(C):在分布式系统中的所有数据备份，在同一时刻是否有相同的值
+ 可用性(A):保证每个请求不管成功或者失败都有相应!!!
+ 分区容忍性(P):系统中任意信息的丢失或失败不会影响系统的继续运作


## 细说CAP

+ Consisteny(一致性):比如数据库是主从模式,一个写库请求进来了，master库完成了写入操作，但是在slave同步数据之前，另一个用户查了这个数据，结果没查到，但是也没报错，这就不是强一致性。**虽然最终会同步成功，但这是最终一致性的体现。**强一致性的体现在于我不管你因为什么没有同步成功(可能网络延迟或其他等)，只要没同步成功，我这个slave就不能对外提供服务，必须主从数据一致才可以提供服务。
+ Availability(可用性):还是上面的例子，就是保证了可用性。因为虽然主从没同步完成，但是我从库照样能提供服务而且及时响应结果。**也就是说可用性保证服务可用，而不在乎数据是否一致。**
+ Partition Tolerance(分区容错性):集群部署了三台服务。挂了一台，其他两台还能继续对外提供服务，这时候我就认为他是没问题的，也就是我能容忍你挂了一台，只要还有服务能对外提供请求即可。所以一般分区容错性是必须的。


## BASE

BASE是basically available、soft state和Eventually consistent三个短语的简写，base是对cap中一致性和可用性权衡的结果，其来源于对大规模互联网系统分布式实践的结论，是基于CAP定理逐步演化而来的，其核心思想是即使无法做到强一致性，但每个应用都可以根据自己的业务特点，采用适当的方式来使系统达到最终一致性。

+ basically available是指分布式系统在出现不可预知故障时，允许损失部分可用性--但请注意，这绝不等价于系统不可用。
+ 弱状态也称为软状态，和硬状态相对，是指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即允许系统在不同节点的数据副本之间进行数据同步的过程存在延时
+ 最终一致性强调的是系统中所有的数据副本，经过一段时间的同步后，最终能够达到一个一致的状态。因此，最终一致性的本质是需要系统保证数据能够达到一致，而不需要实时保证系统数据的强一致性。

总的来说，BASE理论面向的是大型高可用可扩展的分布式系统，提出牺牲强一致性来获得可用性，并允许数据在一段时间内是不一致的，但最终达到一致状态。